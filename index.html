<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vật Lý 11 - Chương 1: Dao Động</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <!-- KaTeX for beautiful math rendering -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
      xintegrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV"
      crossorigin="anonymous"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
      xintegrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0i8"
      crossorigin="anonymous"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
      xintegrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
      crossorigin="anonymous"
    ></script>

    <style>
      body {
        font-family: "Be Vietnam Pro", sans-serif;
        background-color: #f8fafc; /* Slate 50 */
      }
      .nav-btn {
        transition: all 0.3s ease;
        border-bottom-width: 4px;
        border-color: transparent;
      }
      .nav-btn.active {
        border-color: #0ea5e9; /* Sky 500 */
        color: #0c4a6e; /* Sky 900 */
        background-color: #e0f2fe; /* Sky 100 */
      }
      .content-section {
        display: none;
      }
      .content-section.active {
        display: block;
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .formula-card {
        background-color: #f0f9ff; /* Sky 50 */
        border-left: 4px solid #38bdf8; /* Sky 400 */
        padding: 1rem;
        border-radius: 0.5rem;
      }
      .concept-card {
        background: white;
        border-radius: 0.75rem;
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }
      .chart-container {
        position: relative;
        width: 100%;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        height: 350px;
      }
      /* Custom checkbox styles */
      .toggle-checkbox:checked {
        background-color: #0ea5e9;
        border-color: #0ea5e9;
      }
      .toggle-checkbox:checked + .toggle-label {
        color: #0c4a6e;
        font-weight: 600;
      }

      /* Animation for Simple Pendulum */
      .pendulum-container {
        position: relative;
        width: 150px;
        height: 200px;
        margin: 20px auto;
      }
      .pendulum-pivot {
        width: 20px;
        height: 10px;
        background: #475569; /* Slate 600 */
        border-radius: 5px;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        z-index: 2;
      }
      .pendulum-rod {
        width: 2px;
        height: 150px;
        background: #64748b; /* Slate 500 */
        position: absolute;
        left: 50%;
        transform-origin: top center;
        animation: swing 4s ease-in-out infinite;
      }
      .pendulum-bob {
        width: 30px;
        height: 30px;
        background: #0ea5e9; /* Sky 500 */
        border-radius: 50%;
        position: absolute;
        bottom: -15px;
        left: -14px;
      }
      @keyframes swing {
        0%,
        100% {
          transform: rotate(45deg);
        }
        50% {
          transform: rotate(-45deg);
        }
      }

      /* Animation for Spring Pendulum */
      .spring-container {
        position: relative;
        width: 150px;
        height: 250px;
        margin: 20px auto;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .spring-support {
        width: 100px;
        height: 10px;
        background: #475569; /* Slate 600 */
        border-radius: 5px;
      }
      .spring-mass {
        width: 50px;
        height: 50px;
        background: #10b981; /* Emerald 500 */
        border-radius: 8px;
        position: absolute;
        bottom: 0;
        left: 50px;
        animation: bounce 2s ease-in-out infinite;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }
      .spring-coil {
        width: 20px;
        height: 150px;
        border: 2px solid #64748b;
        border-bottom: none;
        border-radius: 10px 10px 0 0;
        position: absolute;
        top: 10px;
        left: 65px;
        transform-origin: top;
        animation: stretch 2s ease-in-out infinite;
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-100px);
        }
      }
      @keyframes stretch {
        0%,
        100% {
          height: 150px;
        }
        50% {
          height: 50px;
        }
      }
    </style>
  </head>
  <body class="text-slate-800">
    <header class="bg-white shadow-md sticky top-0 z-10">
      <div class="container mx-auto px-4 py-4">
        <h1 class="text-2xl md:text-3xl font-bold text-sky-800">
          Chương I: Dao Động
        </h1>
        <p class="text-slate-600 mt-1">
          Khám phá các khái niệm về dao động một cách trực quan và tương tác.
        </p>
      </div>
    </header>

    <nav class="bg-white shadow-sm mb-8">
      <div class="container mx-auto px-4 flex flex-wrap justify-center">
        <button
          class="nav-btn active py-3 px-2 md:px-4 text-sm md:text-base font-semibold text-slate-600 hover:bg-sky-50"
          data-target="lesson-1-2"
        >
          Bài 1-2: DĐĐH & Mô tả
        </button>
        <button
          class="nav-btn py-3 px-2 md:px-4 text-sm md:text-base font-semibold text-slate-600 hover:bg-sky-50"
          data-target="lesson-3-5"
        >
          Bài 3-5: Vận tốc, Gia tốc & Năng lượng
        </button>
        <button
          class="nav-btn py-3 px-2 md:px-4 text-sm md:text-base font-semibold text-slate-600 hover:bg-sky-50"
          data-target="lesson-6"
        >
          Bài 6: Các loại Dao động
        </button>
        <button
          class="nav-btn py-3 px-2 md:px-4 text-sm md:text-base font-semibold text-slate-600 hover:bg-sky-50"
          data-target="simulations"
        >
          Mô Phỏng & Thí Nghiệm
        </button>
      </div>
    </nav>

    <main class="container mx-auto px-4 pb-12">
      <!-- Bài 1 & 2: Dao động điều hòa và Mô tả dao động -->
      <section id="lesson-1-2" class="content-section active">
        <h2 class="text-2xl font-bold text-sky-700 mb-4">
          Bài 1 & 2: Dao Động Điều Hoà và Các Đại Lượng Đặc Trưng
        </h2>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            1. Các Khái Niệm Cơ Bản
          </h3>
          <p class="mb-2">
            <strong class="font-medium text-sky-600">Dao động cơ:</strong>
            Chuyển động lặp đi lặp lại quanh một vị trí cân bằng.
          </p>
          <p class="mb-2">
            <strong class="font-medium text-sky-600"
              >Dao động tuần hoàn:</strong
            >
            Sau những khoảng thời gian bằng nhau (chu kì), vật trở lại vị trí cũ
            theo hướng cũ. Ví dụ: dao động của con lắc đồng hồ.
          </p>
          <p class="mb-2">
            <strong class="font-medium text-sky-600"
              >Dao động điều hoà (DĐĐH):</strong
            >
            Là dao động tuần hoàn trong đó li độ của vật là một hàm côsin (hay
            sin) của thời gian. Đây là dạng dao động cơ đơn giản nhất.
          </p>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            2. Phương Trình Dao Động Điều Hoà
          </h3>
          <div class="grid md:grid-cols-2 gap-6 items-center">
            <div>
              <h4 class="font-semibold text-lg mb-2">Phương trình li độ</h4>
              <div class="formula-card text-center text-xl">
                $x = A\cos(\omega t + \phi)$
              </div>
              <ul class="list-disc list-inside mt-3 space-y-1 text-slate-600">
                <li>$x$: li độ - vị trí của vật tại thời điểm t.</li>
                <li>$A$: biên độ - li độ cực đại (A > 0).</li>
                <li>$\omega$: tần số góc (rad/s).</li>
                <li>$(\omega t + \phi)$: pha dao động tại thời điểm t.</li>
                <li>
                  $\phi$: pha ban đầu - xác định trạng thái dao động tại t=0.
                </li>
              </ul>
            </div>
            <div class="chart-container" style="height: 250px">
              <canvas id="shmGraph"></canvas>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            3. Các Đại Lượng Đặc Trưng
          </h3>
          <p class="text-slate-600 mb-4">
            Biên độ, chu kì, tần số và tần số góc là những hằng số đặc trưng cho
            một dao động cụ thể.
          </p>
          <div class="grid md:grid-cols-3 gap-4">
            <div class="formula-card">
              <h4 class="font-semibold">Chu kì (T)</h4>
              <p>$T = \frac{2\pi}{\omega} = \frac{1}{f}$</p>
              <p class="text-sm text-slate-600">
                Khoảng thời gian để vật thực hiện được một dao động (s).
              </p>
            </div>
            <div class="formula-card">
              <h4 class="font-semibold">Tần số (f)</h4>
              <p>$f = \frac{1}{T} = \frac{\omega}{2\pi}$</p>
              <p class="text-sm text-slate-600">
                Số dao động mà vật thực hiện được trong một giây (Hz).
              </p>
            </div>
            <div class="formula-card">
              <h4 class="font-semibold">Tần số góc ($\omega$)</h4>
              <p>$\omega = 2\pi f = \frac{2\pi}{T}$</p>
              <p class="text-sm text-slate-600">
                Đặc trưng cho tốc độ biến thiên của pha (rad/s).
              </p>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            4. Pha và Độ Lệch Pha
          </h3>
          <p class="mb-4 text-slate-600">
            Pha ban đầu ($\phi$) xác định trạng thái xuất phát của dao động. Độ
            lệch pha ($\Delta\phi$) cho biết sự sớm hay trễ pha giữa hai dao
            động cùng chu kì.
          </p>
          <div class="formula-card mb-4 text-center text-lg">
            Độ lệch pha: $\Delta\phi = (\omega t + \phi_2) - (\omega t + \phi_1)
            = \phi_2 - \phi_1$
          </div>
          <div class="grid md:grid-cols-3 gap-4 text-center">
            <div class="bg-slate-100 p-4 rounded-lg">
              <h4 class="font-semibold">Cùng pha</h4>
              <p>$\Delta\phi = 2k\pi$</p>
            </div>
            <div class="bg-slate-100 p-4 rounded-lg">
              <h4 class="font-semibold">Ngược pha</h4>
              <p>$\Delta\phi = (2k+1)\pi$</p>
            </div>
            <div class="bg-slate-100 p-4 rounded-lg">
              <h4 class="font-semibold">Vuông pha</h4>
              <p>$\Delta\phi = (2k+1)\frac{\pi}{2}$</p>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            5. Minh Họa Độ Lệch Pha
          </h3>
          <p class="text-slate-600 mb-4">
            Các đồ thị dưới đây cho thấy hai dao động (nét liền và nét đứt)
            trong các trường hợp lệch pha khác nhau.
          </p>
          <div class="grid md:grid-cols-3 gap-8 mt-4 text-center">
            <div>
              <h4 class="font-semibold mb-2">Cùng Pha ($\Delta\phi = 0$)</h4>
              <div class="chart-container" style="height: 150px">
                <canvas id="inPhaseChart"></canvas>
              </div>
            </div>
            <div>
              <h4 class="font-semibold mb-2">Ngược Pha ($\Delta\phi = \pi$)</h4>
              <div class="chart-container" style="height: 150px">
                <canvas id="outOfPhaseChart"></canvas>
              </div>
            </div>
            <div>
              <h4 class="font-semibold mb-2">
                Vuông Pha ($\Delta\phi = \pi/2$)
              </h4>
              <div class="chart-container" style="height: 150px">
                <canvas id="quadraturePhaseChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Bài 3 & 5: Vận tốc, Gia tốc và Năng lượng -->
      <section id="lesson-3-5" class="content-section">
        <h2 class="text-2xl font-bold text-sky-700 mb-4">
          Bài 3 & 5: Vận Tốc, Gia Tốc và Năng Lượng
        </h2>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            1. Vận Tốc và Gia Tốc
          </h3>
          <p class="mb-4 text-slate-600">
            Vận tốc và gia tốc trong DĐĐH cũng biến thiên điều hoà nhưng lệch
            pha so với li độ.
          </p>
          <div class="grid md:grid-cols-2 gap-4">
            <div class="formula-card">
              <h4 class="font-semibold">Vận tốc (v)</h4>
              <p>$v = x' = -\omega A\sin(\omega t + \phi)$</p>
              <p>$v = \omega A\cos(\omega t + \phi + \frac{\pi}{2})$</p>
              <p class="text-sm text-slate-600 mt-2">
                Sớm pha $\frac{\pi}{2}$ so với li độ $x$. Đạt cực đại tại VTCB,
                bằng 0 tại biên.
              </p>
            </div>
            <div class="formula-card">
              <h4 class="font-semibold">Gia tốc (a)</h4>
              <p>$a = v' = -\omega^2 A\cos(\omega t + \phi)$</p>
              <p>$a = -\omega^2x$</p>
              <p class="text-sm text-slate-600 mt-2">
                Ngược pha so với li độ $x$, sớm pha $\frac{\pi}{2}$ so với vận
                tốc $v$. Đạt cực đại tại biên, bằng 0 tại VTCB.
              </p>
            </div>
          </div>
          <div class="chart-container mt-4">
            <canvas id="xvaChart"></canvas>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            2. Năng Lượng trong DĐĐH
          </h3>
          <p class="mb-4 text-slate-600">
            Trong DĐĐH, cơ năng được bảo toàn (khi không có ma sát). Động năng
            và thế năng biến thiên tuần hoàn, chuyển hóa qua lại lẫn nhau.
          </p>
          <div class="grid md:grid-cols-3 gap-4">
            <div class="formula-card">
              <h4 class="font-semibold">Động năng</h4>
              <p>$W_đ = \frac{1}{2}mv^2$</p>
              <p>$W_đ = \frac{1}{2}m\omega^2(A^2-x^2)$</p>
            </div>
            <div class="formula-card">
              <h4 class="font-semibold">Thế năng</h4>
              <p>$W_t = \frac{1}{2}kx^2$</p>
              <p>$W_t = \frac{1}{2}m\omega^2x^2$</p>
            </div>
            <div class="formula-card">
              <h4 class="font-semibold">Cơ năng</h4>
              <p>$W = W_đ + W_t$</p>
              <p>$W = \frac{1}{2}m\omega^2A^2 = \text{hằng số}$</p>
            </div>
          </div>
          <div class="chart-container mt-4">
            <canvas id="energyChart"></canvas>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            3. Các Hệ Dao Động Cơ Học
          </h3>
          <div class="grid md:grid-cols-2 gap-8 mt-4 items-start">
            <!-- Con lắc lò xo -->
            <div class="text-center">
              <h4 class="text-lg font-semibold mb-2 text-emerald-700">
                Con lắc lò xo
              </h4>
              <p class="text-slate-600 min-h-[4rem]">
                Gồm một vật nhỏ khối lượng $m$ gắn vào một lò xo có độ cứng $k$.
                Thế năng là thế năng đàn hồi.
              </p>
              <div class="spring-container">
                <div class="spring-support"></div>
                <div class="spring-coil"></div>
                <div class="spring-mass">m</div>
              </div>
              <div class="formula-card mt-2">
                <p>Tần số góc: $\omega = \sqrt{\frac{k}{m}}$</p>
                <p>Chu kì: $T = 2\pi\sqrt{\frac{m}{k}}$</p>
              </div>
            </div>
            <!-- Con lắc đơn -->
            <div class="text-center">
              <h4 class="text-lg font-semibold mb-2 text-sky-700">
                Con lắc đơn
              </h4>
              <p class="text-slate-600 min-h-[4rem]">
                Gồm một vật nhỏ khối lượng $m$ treo ở đầu một sợi dây dài $l$.
                Thế năng là thế năng trọng trường.
              </p>
              <div class="pendulum-container">
                <div class="pendulum-pivot"></div>
                <div class="pendulum-rod"><div class="pendulum-bob"></div></div>
              </div>
              <div class="formula-card mt-2">
                <p>Tần số góc: $\omega = \sqrt{\frac{g}{l}}$</p>
                <p>Chu kì: $T = 2\pi\sqrt{\frac{l}{g}}$</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Bài 6: Các loại dao động khác -->
      <section id="lesson-6" class="content-section">
        <h2 class="text-2xl font-bold text-sky-700 mb-4">
          Bài 6: Dao Động Tắt Dần, Cưỡng Bức và Cộng Hưởng
        </h2>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            1. Phân Loại Các Dao Động
          </h3>
          <div class="grid md:grid-cols-2 gap-4">
            <div class="p-4 bg-slate-50 rounded-lg">
              <h4 class="font-semibold text-sky-700">Dao động tự do</h4>
              <p class="text-slate-600 text-sm">
                Dao động với tần số riêng $f_0$ không đổi, chỉ phụ thuộc vào đặc
                tính của hệ, không chịu tác dụng của lực cản.
              </p>
            </div>
            <div class="p-4 bg-slate-50 rounded-lg">
              <h4 class="font-semibold text-amber-700">Dao động tắt dần</h4>
              <p class="text-slate-600 text-sm">
                Dao động có biên độ giảm dần theo thời gian do lực cản môi
                trường làm cơ năng chuyển hóa thành nhiệt năng.
              </p>
            </div>
            <div class="p-4 bg-slate-50 rounded-lg">
              <h4 class="font-semibold text-emerald-700">Dao động cưỡng bức</h4>
              <p class="text-slate-600 text-sm">
                Dao động chịu tác dụng của ngoại lực tuần hoàn $F =
                F_0\cos(\omega t)$. Dao động có tần số bằng tần số của ngoại
                lực.
              </p>
            </div>
            <div class="p-4 bg-slate-50 rounded-lg">
              <h4 class="font-semibold text-rose-700">Hiện tượng cộng hưởng</h4>
              <p class="text-slate-600 text-sm">
                Biên độ dao động cưỡng bức tăng đến cực đại khi tần số lực cưỡng
                bức $f$ bằng tần số riêng $f_0$ của hệ.
              </p>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            2. Đồ thị các loại dao động
          </h3>
          <p class="mb-4 text-slate-600">
            Chọn một loại dao động để xem đồ thị li độ theo thời gian của nó.
          </p>
          <div
            class="flex justify-center space-x-2 md:space-x-4 mb-4 flex-wrap"
          >
            <button
              id="btn-free"
              class="px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition"
            >
              Tự do
            </button>
            <button
              id="btn-damped"
              class="px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition"
            >
              Tắt dần
            </button>
            <button
              id="btn-forced"
              class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition"
            >
              Cưỡng bức
            </button>
          </div>
          <div class="chart-container">
            <canvas id="oscillationTypeChart"></canvas>
          </div>
          <div
            id="oscillation-description"
            class="mt-4 p-4 bg-slate-100 rounded-lg text-slate-700"
          >
            <!-- Description will be loaded by JS -->
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            3. Đồ Thị Cộng Hưởng
          </h3>
          <p class="text-slate-600 mb-4">
            Đồ thị biểu diễn sự phụ thuộc của biên độ dao động cưỡng bức (A) vào
            tần số của ngoại lực ($f$). Đồ thị càng nhọn khi lực cản của môi
            trường càng nhỏ.
          </p>
          <div class="chart-container">
            <canvas id="resonanceChart"></canvas>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            4. Ứng Dụng và Tác Hại của Cộng Hưởng
          </h3>
          <p class="text-slate-600">
            Hiện tượng này có cả ứng dụng lợi và hại trong thực tế.
          </p>
          <div class="mt-4 grid md:grid-cols-2 gap-4">
            <div
              class="bg-emerald-50 border-l-4 border-emerald-500 p-4 rounded"
            >
              <h4 class="font-bold text-emerald-800">Có Lợi</h4>
              <p>
                Hộp đàn guitar, violon (khuếch đại âm thanh), mạch chọn sóng
                trong radio, TV, lò vi sóng (làm nóng thức ăn).
              </p>
            </div>
            <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
              <h4 class="font-bold text-red-800">Có Hại</h4>
              <p>
                Các công trình như cầu, tòa nhà, bệ máy có thể bị rung lắc mạnh
                đến sụp đổ nếu tần số của ngoại lực (gió, động cơ, bước chân
                đoàn người) trùng với tần số riêng.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Mô phỏng -->
      <section id="simulations" class="content-section">
        <h2 class="text-2xl font-bold text-sky-700 mb-4">
          Thí Nghiệm Tương Tác
        </h2>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            1. Thí Nghiệm Tổng Hợp
          </h3>
          <p class="mb-8 text-slate-600">
            Thay đổi các thông số của một dao động điều hoà để quan sát sự thay
            đổi trên đồ thị li độ, vận tốc, gia tốc và năng lượng.
          </p>
          <div class="grid lg:grid-cols-3 gap-6">
            <!-- Controls -->
            <div class="lg:col-span-1 space-y-4">
              <h4 class="text-lg font-semibold text-slate-700">
                Bảng điều khiển
              </h4>
              <div>
                <label for="amplitude" class="block font-medium mb-1"
                  >Biên độ A (cm)</label
                >
                <input
                  type="range"
                  id="amplitude"
                  min="1"
                  max="10"
                  value="5"
                  step="0.5"
                  class="w-full"
                />
                <p class="text-center mt-1">
                  A = <span id="amplitudeValue">5.0</span> cm
                </p>
              </div>
              <div>
                <label for="omega" class="block font-medium mb-1"
                  >Tần số góc $\omega$ (rad/s)</label
                >
                <input
                  type="range"
                  id="omega"
                  min="0.5"
                  max="5"
                  value="2"
                  step="0.1"
                  class="w-full"
                />
                <p class="text-center mt-1">
                  $\omega$ = <span id="omegaValue">2.0</span> rad/s
                </p>
              </div>
              <div>
                <label for="phi" class="block font-medium mb-1"
                  >Pha ban đầu $\phi$ ($\times \pi$ rad)</label
                >
                <input
                  type="range"
                  id="phi"
                  min="-1"
                  max="1"
                  value="0"
                  step="0.1"
                  class="w-full"
                />
                <p class="text-center mt-1">
                  $\phi$ = <span id="phiValue">0.00</span>$\pi$ rad
                </p>
              </div>

              <h4 class="font-semibold pt-2">Hiển thị đồ thị</h4>
              <div class="space-y-2">
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="showX"
                    class="toggle-checkbox h-4 w-4 rounded border-gray-300 text-sky-600 focus:ring-sky-500"
                    checked
                  />
                  <label
                    for="showX"
                    class="ml-2 block text-sm text-gray-900 toggle-label"
                    >Li độ (x)</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="showV"
                    class="toggle-checkbox h-4 w-4 rounded border-gray-300 text-sky-600 focus:ring-sky-500"
                    checked
                  />
                  <label
                    for="showV"
                    class="ml-2 block text-sm text-gray-900 toggle-label"
                    >Vận tốc (v)</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="showA"
                    class="toggle-checkbox h-4 w-4 rounded border-gray-300 text-sky-600 focus:ring-sky-500"
                    checked
                  />
                  <label
                    for="showA"
                    class="ml-2 block text-sm text-gray-900 toggle-label"
                    >Gia tốc (a)</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="showEnergy"
                    class="toggle-checkbox h-4 w-4 rounded border-gray-300 text-sky-600 focus:ring-sky-500"
                  />
                  <label
                    for="showEnergy"
                    class="ml-2 block text-sm text-gray-900 toggle-label"
                    >Năng lượng (W, Wđ, Wt)</label
                  >
                </div>
              </div>
            </div>
            <!-- Chart and Animation -->
            <div class="lg:col-span-2">
              <div class="relative w-full aspect-[4/3] max-h-[500px]">
                <canvas id="interactiveChart"></canvas>
              </div>
              <div class="mt-4">
                <h4 class="text-center font-semibold">Mô phỏng vật</h4>
                <canvas
                  id="massAnimation"
                  height="80"
                  class="w-full bg-slate-50 rounded-lg mt-2"
                ></canvas>
              </div>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3 class="text-xl font-semibold mb-3 text-slate-700">
            2. Tương Tác: Khảo Sát Độ Lệch Pha
          </h3>
          <p class="mb-4 text-slate-600">
            Sử dụng các thanh trượt để thay đổi pha ban đầu của hai dao động và
            quan sát sự thay đổi trên đồ thị cũng như giá trị độ lệch pha.
          </p>
          <div class="chart-container">
            <canvas id="phaseShiftChart"></canvas>
          </div>
          <div class="grid md:grid-cols-2 gap-6 mt-6">
            <div>
              <label for="phi1" class="block font-medium mb-1"
                >Pha ban đầu $\phi_1$ ($ \times\pi$ rad)</label
              >
              <input
                type="range"
                id="phi1"
                min="-1"
                max="1"
                value="0"
                step="0.1"
                class="w-full"
              />
              <p class="text-center mt-1">
                $\phi_1 = $ <span id="phi1Value">0.00</span>$\pi$ rad
              </p>
            </div>
            <div>
              <label for="phi2" class="block font-medium mb-1"
                >Pha ban đầu $\phi_2$ ($ \times\pi$ rad)</label
              >
              <input
                type="range"
                id="phi2"
                min="-1"
                max="1"
                value="0.5"
                step="0.1"
                class="w-full"
              />
              <p class="text-center mt-1">
                $\phi_2 = $ <span id="phi2Value">0.50</span>$\pi$ rad
              </p>
            </div>
          </div>
          <div
            class="mt-4 text-center text-lg font-semibold bg-sky-100 text-sky-800 p-3 rounded-md"
          >
            Độ lệch pha $\Delta\phi = $
            <span id="deltaPhiValue">0.50</span>$\pi$ rad
          </div>
        </div>
      </section>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const navButtons = document.querySelectorAll(".nav-btn");
        const contentSections = document.querySelectorAll(".content-section");
        let charts = {};

        // Render math formulas with KaTeX
        renderMathInElement(document.body, {
          delimiters: [
            { left: "$$", right: "$$", display: true },
            { left: "$", right: "$", display: false },
          ],
          throwOnError: false,
        });

        // --- Tab Navigation ---
        function switchTab(targetId) {
          contentSections.forEach((section) =>
            section.classList.remove("active")
          );
          navButtons.forEach((button) => button.classList.remove("active"));
          document.getElementById(targetId).classList.add("active");
          document
            .querySelector(`[data-target="${targetId}"]`)
            .classList.add("active");
          initializeForTab(targetId);
        }

        navButtons.forEach((button) => {
          button.addEventListener("click", () =>
            switchTab(button.getAttribute("data-target"))
          );
        });

        // --- Chart & Simulation Initialization ---
        function initializeForTab(targetId) {
          if (charts[targetId]) return;

          switch (targetId) {
            case "lesson-1-2":
              createShmGraph();
              createPhaseCharts();
              break;
            case "lesson-3-5":
              createXvaChart();
              createEnergyChart();
              break;
            case "lesson-6":
              createOscillationTypeChart();
              createResonanceChart();
              break;
            case "simulations":
              setupComprehensiveSimulation();
              createPhaseShiftChart();
              break;
          }
          charts[targetId] = true;
        }

        const chartDefaultOptions = {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: "index", intersect: false },
          plugins: { legend: { position: "top" } },
        };

        function createShmGraph() {
          const ctx = document.getElementById("shmGraph").getContext("2d");
          const labels = Array.from({ length: 51 }, (_, i) =>
            (i * 0.25).toFixed(2)
          );
          charts["shmGraphObj"] = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Li độ x (cm)",
                  data: labels.map((t) => 10 * Math.cos((Math.PI / 2) * t)),
                  borderColor: "#38bdf8",
                  backgroundColor: "rgba(56, 189, 248, 0.1)",
                  fill: true,
                  tension: 0.4,
                },
              ],
            },
            options: {
              ...chartDefaultOptions,
              scales: {
                x: { title: { display: true, text: "t(s)" } },
                y: { title: { display: true, text: "x(cm)" } },
              },
            },
          });
        }

        function createXvaChart() {
          const ctx = document.getElementById("xvaChart").getContext("2d");
          const A = 5,
            omega = Math.PI;
          const labels = Array.from({ length: 41 }, (_, i) =>
            (i * 0.1).toFixed(1)
          );
          charts["xvaChartObj"] = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Li độ x (cm)",
                  data: labels.map((t) => A * Math.cos(omega * t)),
                  borderColor: "#38bdf8",
                  fill: false,
                  tension: 0.1,
                  yAxisID: "y",
                },
                {
                  label: "Vận tốc v (cm/s)",
                  data: labels.map((t) => -A * omega * Math.sin(omega * t)),
                  borderColor: "#10b981",
                  fill: false,
                  tension: 0.1,
                  yAxisID: "y1",
                },
                {
                  label: "Gia tốc a (cm/s²)",
                  data: labels.map(
                    (t) => -A * omega * omega * Math.cos(omega * t)
                  ),
                  borderColor: "#f97316",
                  fill: false,
                  tension: 0.1,
                  yAxisID: "y2",
                },
              ],
            },
            options: {
              ...chartDefaultOptions,
              scales: {
                x: { title: { display: true, text: "Thời gian (s)" } },
                y: {
                  type: "linear",
                  display: true,
                  position: "left",
                  title: { display: true, text: "Li độ (cm)" },
                },
                y1: {
                  type: "linear",
                  display: true,
                  position: "right",
                  grid: { drawOnChartArea: false },
                  title: { display: true, text: "Vận tốc (cm/s)" },
                },
                y2: { display: false },
              },
            },
          });
        }

        function createEnergyChart() {
          const ctx = document.getElementById("energyChart").getContext("2d");
          const W = 1;
          const labels = Array.from({ length: 51 }, (_, i) =>
            (i * 0.1 * Math.PI).toFixed(2)
          );
          charts["energyChartObj"] = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Động năng (Wđ)",
                  data: labels.map((t) => W * Math.pow(Math.sin(2 * t), 2)),
                  backgroundColor: "rgba(16, 185, 129, 0.5)",
                  borderColor: "#10b981",
                  fill: true,
                  tension: 0.4,
                },
                {
                  label: "Thế năng (Wt)",
                  data: labels.map((t) => W * Math.pow(Math.cos(2 * t), 2)),
                  backgroundColor: "rgba(56, 189, 248, 0.5)",
                  borderColor: "#38bdf8",
                  fill: true,
                  tension: 0.4,
                },
                {
                  label: "Cơ năng (W)",
                  data: labels.map(() => W),
                  borderColor: "#ef4444",
                  fill: false,
                  borderWidth: 3,
                },
              ],
            },
            options: {
              ...chartDefaultOptions,
              scales: {
                y: {
                  beginAtZero: true,
                  stacked: true,
                  title: { display: true, text: "Năng lượng (J)" },
                },
                x: { title: { display: true, text: "Pha dao động (rad)" } },
              },
            },
          });
        }

        function createPhaseCharts() {
          const labels = Array.from({ length: 51 }, (_, i) =>
            (i * 0.1).toFixed(1)
          );
          const data1 = labels.map((t) => 10 * Math.cos(2 * Math.PI * t));
          const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              x: { ticks: { display: false }, grid: { display: false } },
              y: { ticks: { display: false }, grid: { display: false } },
            },
            elements: { line: { tension: 0.4, pointRadius: 0 } },
          };
          new Chart(document.getElementById("inPhaseChart").getContext("2d"), {
            type: "line",
            data: {
              labels,
              datasets: [
                { data: data1, borderColor: "#38bdf8" },
                {
                  data: labels.map((t) => 10 * Math.cos(2 * Math.PI * t)),
                  borderColor: "#10b981",
                  borderDash: [5, 5],
                },
              ],
            },
            options: commonOptions,
          });
          new Chart(
            document.getElementById("outOfPhaseChart").getContext("2d"),
            {
              type: "line",
              data: {
                labels,
                datasets: [
                  { data: data1, borderColor: "#38bdf8" },
                  {
                    data: labels.map(
                      (t) => 10 * Math.cos(2 * Math.PI * t + Math.PI)
                    ),
                    borderColor: "#f97316",
                    borderDash: [5, 5],
                  },
                ],
              },
              options: commonOptions,
            }
          );
          new Chart(
            document.getElementById("quadraturePhaseChart").getContext("2d"),
            {
              type: "line",
              data: {
                labels,
                datasets: [
                  { data: data1, borderColor: "#38bdf8" },
                  {
                    data: labels.map(
                      (t) => 10 * Math.cos(2 * Math.PI * t + Math.PI / 2)
                    ),
                    borderColor: "#a855f7",
                    borderDash: [5, 5],
                  },
                ],
              },
              options: commonOptions,
            }
          );
        }

        function createOscillationTypeChart() {
          const ctx = document
            .getElementById("oscillationTypeChart")
            .getContext("2d");
          const descriptionDiv = document.getElementById(
            "oscillation-description"
          );
          const labels = Array.from({ length: 101 }, (_, i) =>
            (i * 0.2).toFixed(1)
          );
          const dataSets = {
            free: {
              label: "Dao động tự do",
              data: labels.map((t) => 10 * Math.cos(2 * Math.PI * t)),
              borderColor: "#0ea5e9",
              description: `<h4 class="font-semibold text-lg">Dao động Tự do</h4><p>Dao động có biên độ và tần số riêng không đổi theo thời gian (khi bỏ qua mọi ma sát).</p>`,
            },
            damped: {
              label: "Dao động tắt dần",
              data: labels.map(
                (t) => 10 * Math.exp(-0.15 * t) * Math.cos(2 * Math.PI * t)
              ),
              borderColor: "#f59e0b",
              description: `<h4 class="font-semibold text-lg">Dao động Tắt dần</h4><p>Dao động có biên độ giảm dần theo thời gian do tác dụng của lực cản, ma sát làm tiêu hao cơ năng.</p>`,
            },
            forced: {
              label: "Dao động cưỡng bức",
              data: labels.map((t) => 8 * Math.cos(1.8 * Math.PI * t)),
              borderColor: "#10b981",
              description: `<h4 class="font-semibold text-lg">Dao động Cưỡng bức</h4><p>Dao động dưới tác dụng của một ngoại lực tuần hoàn. Tần số dao động bằng tần số của ngoại lực, biên độ không đổi.</p>`,
            },
          };
          const chart = new Chart(ctx, {
            type: "line",
            data: { labels: labels, datasets: [dataSets.free] },
            options: {
              ...chartDefaultOptions,
              scales: { y: { min: -12, max: 12 } },
            },
          });
          charts["oscillationTypeChartObj"] = chart;
          descriptionDiv.innerHTML = dataSets.free.description;
          document.getElementById("btn-free").addEventListener("click", () => {
            chart.data.datasets = [dataSets.free];
            chart.update();
            descriptionDiv.innerHTML = dataSets.free.description;
          });
          document
            .getElementById("btn-damped")
            .addEventListener("click", () => {
              chart.data.datasets = [dataSets.damped];
              chart.update();
              descriptionDiv.innerHTML = dataSets.damped.description;
            });
          document
            .getElementById("btn-forced")
            .addEventListener("click", () => {
              chart.data.datasets = [dataSets.forced];
              chart.update();
              descriptionDiv.innerHTML = dataSets.forced.description;
            });
        }

        function createResonanceChart() {
          const ctx = document
            .getElementById("resonanceChart")
            .getContext("2d");
          const f0 = 5.0;
          const createResonanceData = (damping) => {
            let data = [];
            for (let f = 0; f <= 10; f += 0.2) {
              const amplitude =
                1 / Math.sqrt(Math.pow(f * f - f0 * f0, 2) + damping * f * f);
              data.push({ x: f, y: amplitude });
            }
            return data;
          };
          charts["resonanceChartObj"] = new Chart(ctx, {
            type: "line",
            data: {
              datasets: [
                {
                  label: "Lực cản nhỏ",
                  data: createResonanceData(1),
                  borderColor: "#ef4444",
                  tension: 0.4,
                  fill: false,
                },
                {
                  label: "Lực cản trung bình",
                  data: createResonanceData(10),
                  borderColor: "#f97316",
                  tension: 0.4,
                  fill: false,
                },
                {
                  label: "Lực cản lớn",
                  data: createResonanceData(50),
                  borderColor: "#f59e0b",
                  tension: 0.4,
                  fill: false,
                },
              ],
            },
            options: {
              ...chartDefaultOptions,
              scales: {
                x: {
                  type: "linear",
                  position: "bottom",
                  title: { display: true, text: "Tần số ngoại lực f (Hz)" },
                },
                y: { title: { display: true, text: "Biên độ A" } },
              },
            },
          });
        }

        function setupComprehensiveSimulation() {
          const controls = {
            amp: document.getElementById("amplitude"),
            omega: document.getElementById("omega"),
            phi: document.getElementById("phi"),
            showX: document.getElementById("showX"),
            showV: document.getElementById("showV"),
            showA: document.getElementById("showA"),
            showEnergy: document.getElementById("showEnergy"),
          };
          const values = {
            amp: document.getElementById("amplitudeValue"),
            omega: document.getElementById("omegaValue"),
            phi: document.getElementById("phiValue"),
          };
          const chartCtx = document
            .getElementById("interactiveChart")
            .getContext("2d");
          const animCanvas = document.getElementById("massAnimation");
          const animCtx = animCanvas.getContext("2d");
          let animFrameId;
          const time = Array.from({ length: 101 }, (_, i) =>
            (i * 0.1).toFixed(1)
          );
          const interactiveChart = new Chart(chartCtx, {
            type: "line",
            data: { labels: time, datasets: [] },
            options: {
              ...chartDefaultOptions,
              scales: {
                x: { title: { display: true, text: "Thời gian t (s)" } },
                y: {
                  type: "linear",
                  position: "left",
                  title: { display: true, text: "x, v, a" },
                },
                yEnergy: {
                  type: "linear",
                  position: "right",
                  grid: { drawOnChartArea: false },
                  title: { display: true, text: "Năng lượng" },
                },
              },
            },
          });
          function updateSimulation() {
            const A = parseFloat(controls.amp.value),
              w = parseFloat(controls.omega.value),
              p = parseFloat(controls.phi.value) * Math.PI,
              m = 0.5,
              k = m * w * w,
              W = 0.5 * k * A * A;
            values.amp.textContent = A.toFixed(1);
            values.omega.textContent = w.toFixed(1);
            values.phi.textContent = (p / Math.PI).toFixed(2);
            const datasets = [];
            if (controls.showX.checked)
              datasets.push({
                label: "Li độ x (cm)",
                data: time.map((t) => A * Math.cos(w * t + p)),
                borderColor: "#38bdf8",
                yAxisID: "y",
                pointRadius: 0,
              });
            if (controls.showV.checked)
              datasets.push({
                label: "Vận tốc v (cm/s)",
                data: time.map((t) => -A * w * Math.sin(w * t + p)),
                borderColor: "#10b981",
                yAxisID: "y",
                pointRadius: 0,
              });
            if (controls.showA.checked)
              datasets.push({
                label: "Gia tốc a (cm/s²)",
                data: time.map((t) => -A * w * w * Math.cos(w * t + p)),
                borderColor: "#f97316",
                yAxisID: "y",
                pointRadius: 0,
              });
            if (controls.showEnergy.checked) {
              datasets.push({
                label: "Động năng Wđ",
                data: time.map(
                  (t) => 0.5 * m * Math.pow(-A * w * Math.sin(w * t + p), 2)
                ),
                borderColor: "#10b981",
                backgroundColor: "rgba(16, 185, 129, 0.2)",
                fill: true,
                yAxisID: "yEnergy",
                pointRadius: 0,
              });
              datasets.push({
                label: "Thế năng Wt",
                data: time.map(
                  (t) => 0.5 * k * Math.pow(A * Math.cos(w * t + p), 2)
                ),
                borderColor: "#38bdf8",
                backgroundColor: "rgba(56, 189, 248, 0.2)",
                fill: true,
                yAxisID: "yEnergy",
                pointRadius: 0,
              });
              datasets.push({
                label: "Cơ năng W",
                data: time.map(() => W),
                borderColor: "#ef4444",
                borderWidth: 3,
                yAxisID: "yEnergy",
                pointRadius: 0,
              });
            }
            interactiveChart.data.datasets = datasets;
            interactiveChart.update();
            if (animFrameId) cancelAnimationFrame(animFrameId);
            window.startTime = performance.now();
            animateMass(window.startTime);
          }
          function animateMass(timestamp) {
            const A_val = parseFloat(controls.amp.value),
              w_val = parseFloat(controls.omega.value),
              p_val = parseFloat(controls.phi.value) * Math.PI;
            const elapsed = (timestamp - window.startTime) / 1000;
            const canvasW = animCanvas.width,
              canvasH = animCanvas.height,
              centerY = canvasH / 2,
              animAmplitude = canvasW / 2 - 20;
            const x_pos = A_val * Math.cos(w_val * elapsed + p_val);
            const screen_x = canvasW / 2 + (x_pos / 10) * animAmplitude;
            animCtx.clearRect(0, 0, canvasW, canvasH);
            animCtx.beginPath();
            animCtx.moveTo(canvasW / 2, 0);
            animCtx.lineTo(canvasW / 2, canvasH);
            animCtx.strokeStyle = "#cbd5e1";
            animCtx.setLineDash([5, 5]);
            animCtx.stroke();
            animCtx.setLineDash([]);
            animCtx.beginPath();
            animCtx.arc(screen_x, centerY, 10, 0, 2 * Math.PI);
            animCtx.fillStyle = "#0ea5e9";
            animCtx.fill();
            animFrameId = requestAnimationFrame(animateMass);
          }
          Object.values(controls).forEach((el) =>
            el.addEventListener("input", updateSimulation)
          );
          updateSimulation();
        }

        function createPhaseShiftChart() {
          const ctx = document
            .getElementById("phaseShiftChart")
            .getContext("2d");
          const phi1Slider = document.getElementById("phi1"),
            phi2Slider = document.getElementById("phi2");
          const phi1Value = document.getElementById("phi1Value"),
            phi2Value = document.getElementById("phi2Value");
          const deltaPhiValue = document.getElementById("deltaPhiValue");
          const labels = Array.from({ length: 101 }, (_, i) =>
            (i * 0.1).toFixed(1)
          );
          function getWaveData(phi) {
            return labels.map(
              (t) => 10 * Math.cos(Math.PI * t + phi * Math.PI)
            );
          }
          const chart = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Dao động 1",
                  data: getWaveData(parseFloat(phi1Slider.value)),
                  borderColor: "#38bdf8",
                  borderWidth: 2,
                  pointRadius: 0,
                },
                {
                  label: "Dao động 2",
                  data: getWaveData(parseFloat(phi2Slider.value)),
                  borderColor: "#10b981",
                  borderWidth: 2,
                  pointRadius: 0,
                  borderDash: [5, 5],
                },
              ],
            },
            options: chartDefaultOptions,
          });
          charts["phaseShiftChartObj"] = chart;
          function updateChart() {
            const phi1 = parseFloat(phi1Slider.value),
              phi2 = parseFloat(phi2Slider.value);
            phi1Value.textContent = phi1.toFixed(2);
            phi2Value.textContent = phi2.toFixed(2);
            deltaPhiValue.textContent = (phi2 - phi1).toFixed(2);
            chart.data.datasets[0].data = getWaveData(phi1);
            chart.data.datasets[1].data = getWaveData(phi2);
            chart.update();
          }
          phi1Slider.addEventListener("input", updateChart);
          phi2Slider.addEventListener("input", updateChart);
          updateChart();
        }

        // --- Initial Load ---
        switchTab("lesson-1-2");
      });
    </script>
  </body>
</html>
